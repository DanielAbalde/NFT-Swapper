<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>NFT SWAPPER</title>
    <meta name="description" content="Peer to peer exchange of multiple NFTs for EVM chains">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:url"                content="https://nft-swapper-sw2zae.spheron.app/" />
    <meta property="og:title"              content="NFT Swapper" />
    <meta property="og:description"        content="Peer to peer exchange of multiple NFTs for EVM chains" />
    <meta property="og:image"              content="./Preview.jpg" />
    <link rel="stylesheet" href="style.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script type="text/javascript"  integrity="sha384-qU3nvpskWirnJuSLmQWFfAFKbiN5+JKbAEEoTOcPYJu3s1xCe66b66sUER3x5wVF" crossorigin="anonymous" src="https://cdn-cors.ethers.io/lib/ethers-5.6.9.umd.min.js"> </script>  
  </head>
  <body>
    <div class="container">
      <div id="topRow" class="row"> 
        <div id="titleDiv" class="topCol">
          <a id="titleLink" href="./index.html"> 
            <h1 id="title">NFT SWAPPER</h1>
            <h7 id="subtitle">Peer to peer exchange of multiple NFT</h7>
          </a> 
        </div> 
        <div id="topNav" class="topCol">
          <a class="topNavLink" href="?view=register">New Swap</a>
          <a class="topNavLink" href="?view=profile">My Swaps</a> 
          <a class="topNavLink" href="?view=about">About</a>
        </div> 
      </div>
      <div id="middleRow" class="row">
        <div id="connect" class="step row">
          <div id="chain" class="connectStep column">
            <form action="" class="botCol">
              <table>
                <tr>
                  <th style="width: 50%;"><label class="formLabel" >Chain</label></th>
                  <th><select id="chains" name="chains" class="formInput" onchange="selectSwapperContract(this)">
                    <option value="Mumbai">Mumbai</option> 
                  </select></th>
                </tr>
                <tr>
                  <th style="width: 50%;"><label class="formLabel" >Standard</label></th>
                  <th><select id="nfttype" name="nfttype" class="formInput" onchange="selectSwapperContract(this)">
                    <option value="ERC721">ERC721</option>
                  </select></th>
                </tr>
                <tr>
                  <th colspan="2"><a id="contractURL" target="_blank" style="justify-content: center; column-span: all;" href="https://mumbai.polygonscan.com/address/0x68fE05bA6C9bd7d43FF255f4D90D8508a605dBfa" rel="noopener noreferrer">NFT Swapper contract</a></th>
                </tr>
              </table>
            </form>
          </div> 
          <div class="connectStep column">
            <table>
              <tr>
                <th><button id="connectButton" onclick="connectButtonClicked()">Connect</button></th>
              </tr>
              <tr>
                <th><a id="connectLabel" ondblclick="copyText('connectLabel')" title="Double click to copy" target="_blank" rel="noopener noreferrer">No wallet connected 🔒</a></th>
              </tr>
            </table> 
           
          </div> 
        
        </div> 
        <div id="register" class="step" style="display: none;"> 
          <form action="javascript:registerButtonClicked()" class="botCol">
            <fieldset >
              <legend ><h3>Register new swap 📑</h3></legend>
            <p class="formDescription">Create a new swap agreement by specifying one NFT contract address for each token ID. Separate with comma for multiple contracts/ids. You can create an open swap agreement by no specifying Owner B. Once complete you will get its Swap ID.</p>
            <table>
              <tr>
                <th style="width: 15%;"><label for="ownerA" class="formLabel" >Owner A</label></th>
                <th ><input type="text" id="ownerA" name="ownerA"  placeholder="0x..." class="formInput"  title="The owner of the Token Ids A on NFT Contract A" required></input></th>
              </tr>
              <tr>
                <th style="width: 15%;"><label for="nftAddressesA" class="formLabel">NFT Contract A</label></th>
                <th><input type="text" id="nftAddressesA" name="nftAddressesA" placeholder="0x..." class="formInput" title="The NFT contract addresses of the Token Ids A to swap. Separate by commas if you want to exchange multiple NFTs. Must be the same amount as Token Ids A." multiple required></th>
              </tr>
              <tr>
                <th style="width: 15%;"><label for="tokenIdsA" class="formLabel">Token Ids A</label></th>
                <th ><input type="text" id="tokenIdsA" name="tokenIdsA" placeholder="0" class="formInput" title="The Token Ids A to swap. Separate by commas if you want to exchange multiple NFTs. Must be the same amount as NFT Contract A." multiple required></th>
              </tr>   
              <tr><th style="color:rgb(50, 50, 50)">.</th></tr>
              <tr>
                <th style="width: 15%;"><label for="ownerB" class="formLabel">Owner B</label></th>
                <th><input type="text" id="ownerB" name="ownerB" placeholder="0x..." class="formInput" title="The owner of the Token Ids B on NFT Contract B. Leave it empty to accept any owner as an open swap."></th>
              </tr> 
              <tr>
                <th style="width: 15%;"><label for="nftAddressesB" class="formLabel">NFT Contract B</label></th>
                <th><input type="text" id="nftAddressesB" name="nftAddressesB" placeholder="0x..." class="formInput" title="The NFT contract addresses of the Token Ids B to swap. Separate by commas if you want to exchange multiple NFTs. Must be the same amount as Token Ids B."multiple required></th>
              </tr> 
              <tr>
                <th style="width: 15%;"><label for="tokensIdsB" class="formLabel">Token Ids B</label></th>
                <td ><input type="text" id="tokenIdsB" name="tokensIdsB" placeholder="0" class="formInput" title="The Token ID of each NFT Contract B to swap. Separate by commas if you want to exchange multiple NFTs. Must be the same amount as NFT Contract B."multiple required></td> 
              </tr>
              <tr><th style="color:rgb(50, 50, 50)">.</th></tr>
              <tr>
                <th style="width: 15%;"><label for="publicSwap" class="formLabel">Public</label></th>
                <th><select name="publicSwap" id="publicSwap" class="formInput" title="Set false to keep this swap only accesible by owner A and owner B, otherwise is public and can be seen by anyone">
                  <option value="True">True</option>
                  <option value="False">False</option>
                </select></th>
              </tr>
            </table>      
            <br>
            <div class="formGroup formGroupButton">
                <input id="registerButton" type="submit" value="Register new swap" style="margin-bottom: 10px">
                <label id="registeredId" class="formLabel"></label>
            </div>
          </fieldset>
          </form> 
        </div>
        <div id="approve" class="step" style="display: none;">
          <form action="javascript:approveButtonClicked(approveField.value)" class="botCol">
            
            <fieldset>
              <legend ><h3>Approve to transfer 🔌</h3></legend>
            <p class="formDescription">The NFT-Swapper contract must be approved as an operator on the NFT contracts by yourself in order to transfer your NFTs.</p>
            <table>
              <tr>
                <th style="width: 15%;"><label for="approve" class="formLabel" >NFT Addresses</label></th>
                <th><input type="text" id="approveField" name="approve" placeholder="0x..." class="formInput" maxlength="42" minlength="42" title="Approve one by one all the NFT addresses that you own used for the swap." required></input></th>
              </tr>
            </table>
            <br>
            <div class="formGroup formGroupButton">
              <input type="submit" value="Approve to transfer">
           </div>
          </fieldset>
          </form>
        </div>
        <div id="profile" class="step" style="display: none;">
          <div class="swapFilter" id="swapFilter">
            <label for="profileFilter" class="formLabel">Filter: </label> 
            <select name="profileFilter" id="profileFilter" class="formInput" onchange="displayProfile()">
              <option value="All">All</option>
              <option value="Pending">Pending</option>
              <option value="Deposited">Deposited</option>
              <option value="Claimed">Claimed</option>
              <option value="Cancelled">Cancelled</option>
            </select> 
          </div> 
          <div id="loadingSwaps" style="font-style: italic; margin-top:50px; width: 100%; text-align: center;"> Loading your swaps... <span class="emoji" style="display: inline-block; animation: spin 3s infinite linear;">⌛</span></div>

        </div>
        <div id="about" class="step" style="display:none;">
          <h2>About</h2>
          Peer to peer exchange of multiple NFTs for EVM chains.
          <br> <br>When you want to exchange one or more NFTs with another person, so that you give them yours in exchange for them giving you theirs, the first person to send them needs to trust that the second person will do so as well. NFT Swapper solves this problem by using the contract as an intermediary, so that you can only claim each other's NFTs when you have both deposited yours.
          <br> <br>The contracts listed here do not charge any commission, they are free to use. They also have no owner or administration mechanisms so everything is controlled by the user.       
          <div id="guide" class="aboutSection">
            <h3>Guide 🗺️</h3>
            <div id="aboutGuide"> 

              <ol type="1">
                <li>Create a <a href="?view=register#register"><b>new swap agreement</b></a> by registering owners, NFT contract addresses and the token IDs.</li>
                <br>
                <li>Owners of NFTs must <a href="?view=register#aprove"><b>approve</b></a> as operator the Swapper contract address on the NFT contracts.</li>
                <br>
                <li>Both owners have to <a href="?view=profile&page=-1"><b>deposit</b></a> their NFTs in the swap agreement.</li>
                <br>
                <li>One owner can <a href="?view=profile&page=-1"><b>claim</b></a> the swap and both receive the other's NFTs.</li>
                <br>
              </ol>  
            </div>
          </div>
          <div id="contracts" class="aboutSection">
            <h3>Contract Addresses 🔑</h3>
            <div id="aboutContracts"></div>
          </div>
          <div id="contibute" class="aboutSection aboutGuide">
            <h3>Contribute ☕</h3>
            <ul>
              <li>Issues and Pull Request on <a href="https://github.com/DanielAbalde/NFT-Swapper" target="_blank">Github</a> are welcome.</li>
              <li>Let me know if you deploy the contracts on a different EVM blockchain.</li>
              <li>Buy me a coffee at 0x4443049b49Caf8Eb4E9235aA1Efe38FcFA0055a1</li>
              <li>Share it on social media!</li>
            </ul>
          </div>
          <div id="contact" class="aboutSection">
            <h3>Contact ✉️</h3>
            <ul>
              <li><a href="https://www.twitter.com/DGANFT"><i class="fab fa-twitter"> </i> @DGANFT</a></li>
              <li><a href="https://discord.gg/H4WMdnz5nw"><i class="fab fa-discord"> </i> DaniGA#9856</a></li>
            </ul>
          </div>
        </div> 
      </div> 
      <div id="bottomRow">
        <div id="footer" class="footer">
          Developed by <a href="https://linktr.ee/danielabalde" target="_blank">Daniel Abalde</a>. Licensed under <a href="https://www.gnu.org/licenses/gpl-3.0.html" target="_blank">GNUv3</a>.  
        </div> 
      </div>
      <div id="connectToAccess"></div>    
    </div> 
      <div id="loadingSplash" style="min-width: 100%; min-height: 100%; z-index: 9999; position: absolute; top:0; left:0; display:none">
        <svg version="1.1" id="loadingSVG" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  width="100%" height="100%" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">
          <rect x="0" y="0" width="100%" height="100%" style="fill: rgba(255, 0, 175, 0.37);"></rect>
        <rect x="40" y="40" width="20" height="20" fill="none" stroke="#fff" stroke-width="1" >
          <animateTransform attributeName="transform" dur="3s" from="0 50 50" to="360 50 50" type="rotate" id="strokeBox"  attributeType="XML" begin="rectBox.end"/>
        </rect>
        <text x="50" y="50" style="fill: rgb(255, 255, 255); font-size:2px; text-align:center;">
          <tspan x="46.4" y="47">Waiting</tspan>
          <tspan x="48.735" y="51">for</tspan>
          <tspan x="44.1" y="55">confirmation</tspan> 
          <animateTransform attributeName="transform" dur="3s" from="0 50 50" to="360 50 50" type="rotate" attributeType="XML"  begin="rectBox.end"//>
        </text>
        <rect x="40" y="40" width="20" height="20" fill="#fff">
          <animate attributeName="height" dur="5s" attributeType="XML" from="20"  to="0" id="rectBox" fill="freeze" begin="0s;strokeBox.end"/>
        </rect>
      
      </svg>
    </div> 
 
    <script src="dapp.js" defer></script>
      <!--https://github.com/tholman/github-corners-->
      <a href="https://github.com/DanielAbalde/NFT-Swapper" target="_blank" class="github-corner" aria-label="View source on GitHub" style="z-index: 100;">
        <svg width="min(9vw, 80px)" height="min(9vw, 80px)" viewBox="0 0 250 250" style="fill:#fff; color:#151513; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
          <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
          <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
          <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>
          <style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>


  </body>
</html>